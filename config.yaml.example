# config.yaml - 示例配置文件 | Example configuration file
# 全局配置 | Global Configuration
# 配置说明:
# - idle_timeout: 空闲超时通过TCP keepalive实现
#   * 0: 不启用keepalive检测
#   * >0: 启用keepalive，连接空闲指定秒数后开始检测
#   * Linux下实际超时时间约为: idle_timeout + (idle_timeout/3 * 3)
#   * 例如300秒配置，实际约600秒后连接会被关闭
# - max_connections:
#   * 0: 无限制
#   * >0: 限制最大并发连接数
global:
  connect_timeout: 10        # 连接超时时间（秒）
  idle_timeout: 300          # 空闲超时时间（秒），0为不启用keepalive超时检测
  max_connections: 1000      # 最大并发连接数, 0为无限制

# 监听器配置 | Listener Configuration
listeners:
  # TCP 代理 | TCP Proxy
  - bind: "0.0.0.0:8080"
    protocol: TCP
    enable_proxy_protocol: true
    # 负载均衡规则 | Load balancing rules: RoundRobin, WeightedRoundRobin, LeastConnections
    load_balance: RoundRobin
    backends:
      - address: "192.168.1.10:80"
        weight: 1
      - address: "192.168.1.11:80"
        weight: 2

  # UDP 代理 | UDP Proxy
  - bind: "0.0.0.0:2345"
    protocol: UDP
    load_balance: RoundRobin
    backends:
      - address: "8.8.8.8:2345"
        weight: 1
      - address: "8.8.4.4:3456"
        weight: 1
      - address: "1.1.1.1:5555"
        weight: 1
    udp_config:
      session_timeout: 60      # UDP 会话超时时间（秒）
      buffer_size: 4096        # UDP 缓冲区大小
      max_sessions: 1000       # 最大会话数

  # 游戏服务器 UDP 代理 | Game Server UDP Proxy
  - bind: "0.0.0.0:7777"
    protocol: UDP
    load_balance: LeastConnections
    backends:
      - address: "192.168.1.100:7777"
        weight: 1
      - address: "192.168.1.101:7777"
        weight: 1
    udp_config:
      session_timeout: 1800    # 30分钟会话超时
      buffer_size: 65536       # 64KB 缓冲区
      max_sessions: 5000       # 支持更多会话